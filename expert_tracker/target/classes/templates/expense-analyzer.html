<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Expense Analyzer</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
        background: url('https://picsum.photos/id/7/4728/3168') no-repeat center center fixed;
        background-size: cover;
        color: #f8f9fa; /* Lighter color for better contrast */
        min-height: 100vh;
        text-align: center;
    }
    .container {
        background-color: rgba(0, 0, 0, 0.85); /* Slightly lighter background */
        padding: 20px;
        border-radius: 15px;
        color: #ffffff; /* Bright white text */
        margin-top: 50px;
    }
    /* Improve chart text readability */
    canvas {
        background-color: rgba(255, 255, 255, 0.9); /* Light background for better contrast */
        border-radius: 10px;
    }
    /* Chart titles */
    h4 {
        color: #f1c40f; /* Yellow text for visibility */
        font-weight: bold;
    }
    /* Adjust text size */
    .chart-container, .wide-chart {
        max-width: 50%;
        margin: auto;
        font-size: 16px; /* Increase text size */
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Expense Analysis</h1>
  <a href="/expenses" class="btn btn-secondary mb-3">Back to Expenses</a>

  <!-- Category-wise Expenses (Pie Chart) -->
  <h4>Category-wise Spending</h4>
  <div class="chart-container">
    <canvas id="categoryChart"></canvas>
  </div>

  <!-- Monthly Expenses (Bar Chart) -->
  <h4 class="mt-4">Monthly Expense Trends</h4>
  <div class="wide-chart">
    <canvas id="monthlyChart"></canvas>
  </div>

  <!-- Individual Expense Names (Horizontal Bar Chart) -->
  <h4 class="mt-4">Expense-wise Breakdown</h4>
  <div class="wide-chart">
    <canvas id="expenseChart"></canvas>
  </div>
</div>

<script>
  fetch('/expenses/chart-data')
      .then(response => response.json())
      .then(data => {
          // Category-wise Pie Chart (Smaller size)
          new Chart(document.getElementById('categoryChart'), {
              type: 'pie',
              data: {
                  labels: data.categoryLabels,
                  datasets: [{
                      label: 'Category-wise Spending',
                      data: data.categoryData,
                      backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4CAF50', '#FF9800']
                  }]
              }
          });

          // Monthly Expenses Bar Chart (Smaller size)
          new Chart(document.getElementById('monthlyChart'), {
              type: 'bar',
              data: {
                  labels: data.monthLabels,
                  datasets: [{
                      label: 'Monthly Expenses (₹)',
                      data: data.monthData,
                      backgroundColor: '#36A2EB'
                  }]
              }
          });

          // Expense Names Bar Chart (Smaller size)
          new Chart(document.getElementById('expenseChart'), {
              type: 'bar',
              data: {
                  labels: data.expenseLabels,
                  datasets: [{
                      label: 'Individual Expenses (₹)',
                      data: data.expenseData,
                      backgroundColor: '#FF6384'
                  }]
              },
              options: {
                  indexAxis: 'y' // Horizontal bar chart
              }
          });
      })
      .catch(error => console.error("Error fetching chart data:", error));
</script>
</body>
</html>